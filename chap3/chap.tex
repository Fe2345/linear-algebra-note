\ifx\allfiles\undefined
\documentclass[12pt, a4paper, oneside, UTF8]{ctexbook}
\def\path{../config}
\input{../config/_config}
\begin{document}
% \input{../config/cover}
\else
\fi
%标题
\chapter{线性变换的表示与分解}
	在上一章中，我们研究了线性映射的基础理论。本章中，我们进一步，寻求对线性映射的表示和分解。

	我们已经看到：选定一个映射和两个基，就可以写出矩阵。但是，其实这些矩阵中有些是容易使用的，而有些则是难以处理的。如果有一个基下映射的矩阵我们觉得是良好的，我们常常会称这类矩阵为标准型

	本章中我们不研究所有线性映射，而是聚焦一种特殊的线性映射——线性变换。我们会看到，如果域是代数闭的，在特定条件下我们可以将其写成对角矩阵；而更一般地，它一定可以写成Jordan块组成的分块对角矩阵。

	本章的第一节我们讲述对角标准型的基础工作——特征值、特征向量；第二节讲解对角标准型的定义及判定是否可对角化的方式；

	第三至第七节，我们逐渐搭建出Jordan标准型的理论。
	\section{线性变换的特征值和特征向量}
		在本节和下一节中，我们将解决对角标准型的问题。

		对角标准型的想法是：尽管并非所有线性映射呈现出$A(\alpha )=\lambda \alpha $的形式，但是很多线性映射都呈现为将基向量仅仅进行伸缩的形式。这样的线性映射会在指定基上呈现为对角矩阵，其对角线元素我们一般称为特征值。

		我们首先构建特征值和其基向量——特征向量的理论。
		\subsection{特征值和特征向量的定义}
			\begin{defn}{线性变换的特征值、特征向量、特征子空间}{}
				设$V$是一个$F$上的线性空间，$A \in \hom(V,V)$

				那么如果$\exists \lambda \in F,\alpha \in V,\alpha \neq \mathbf{0}$使得

				\begin{equation}
					A(\alpha )=\lambda \alpha 
				\end{equation}
				成立

				那么我们称$\lambda $是$A$的一个特征值，$\alpha $是$A$的隶属于$\lambda $的一个特征向量

				同时我们定义：
				\begin{equation}
					V_\lambda := \{\alpha | A(\alpha )=\lambda \alpha \}
				\end{equation}
				称为$A$的属于特征值$\lambda $的特征子空间
			\end{defn}
			特征值代表着一个线性映射对一个向量的伸缩程度，这里我们要求至少能找到一个向量不为零是因为：如果一个特征值只对于零向量成立，那么它过于平凡，而且会扰乱后续我们一些关于特征值数量的命题

			类似地，我们自然可以定义矩阵的特征值
			\begin{defn}{矩阵的特征值、特征向量}{}
				设$\symbfit{A} \in M_n(F)$

				那么如果$\exists \lambda \in F,\alpha \in F^n$，使得

				\begin{equation}
					\symbfit{A}\alpha =\lambda \alpha 
				\end{equation}
				成立。

				那么我们称$\lambda $是$\symbfit{A}$的一个特征值，$\alpha $是$\symbfit{A}$的隶属于$\lambda $的一个特征向量
			\end{defn}
		\subsection{特征值和特征向量的性质}
			我们探讨一些相关的基本性质
			\begin{para}{0}
				\point{}

					我们首先验证，特征子空间的确是子空间
					\begin{proposition}
						$\forall A \in \hom(V,V)$，$V_\lambda $是$V$的一个线性子空间
					\end{proposition}
					\begin{proof}
						取$\forall \alpha ,\beta \in V_\lambda ,k \in F$

						$A(\alpha +\beta )=\lambda \alpha +\lambda \beta =\lambda (\alpha +\beta ) \Rightarrow \alpha +\beta \in V_\lambda $

						$A(k\alpha )=k\lambda \alpha =\lambda (k\alpha )\Rightarrow k\alpha \in V_\lambda $

						于是命题得证
					\end{proof}
					请注意：特征子空间并非全体特征向量的集合，而是全体特征向量和零向量的集合
				\point{}
					
					从特征值的定义可以看出，特征值就像是把线性变换的一部分转换为纯量乘法。我们猜想：每一个特征值体现了映射的不同的“方向”，不同特征子空间的线性无关向量组的并也应该线性无关

					以下命题证实了这个猜想
					\begin{proposition}
						设$A \in \hom(V,V)$，$\lambda_1,\lambda_2$是$A$的两个特征值，$\lambda_1\neq \lambda_2$

						如果$\alpha_1,\cdots,\alpha_m \in V_{\lambda_1}$线性无关，$\beta_1,\cdots,\beta_n \in V_{\lambda_2}$线性无关

						那么$\alpha_1,\cdots,\alpha_m,\beta_1,\cdots,\beta_n$也线性无关
					\end{proposition}
					\begin{proof}
						取线性组合并设其为零:

						$k_1\alpha_1+\cdots+k_m\alpha_m+l_1\beta_1+\cdots+l_n\beta_n=\mathbf{0}$

						将$A$在其上进行变换得：$k_1A(\alpha_1)+\cdots+k_mA(\alpha_m)+l_1A(\beta_1)+\cdots+l_nA(\beta_n)=\mathbf{0}$

						$\Rightarrow k_1\lambda_1\alpha_1 +\cdots+k_m\lambda_1\alpha_m+l_1\lambda_2\beta_1+\cdots+l_n\lambda_2\beta_n=\mathbf{0}$

						但是，如果我们把最初的线性组合乘以$\lambda_1$，得：

						$k_1\lambda_1\alpha_1 +\cdots+k_m\lambda_1\alpha_m+l_1\lambda_1\beta_1+\cdots+l_n\lambda_1\beta_n=\mathbf{0}$

						将两式相减，得：

						$l_1(\lambda_2-\lambda_1)\beta_1+\cdots+l_n(\lambda_2-\lambda_1)\beta_n=\mathbf{0}$

						$\Rightarrow \forall i,l_i(\lambda_2-\lambda_1)=0 \Rightarrow l_i=0$

						$\Rightarrow k_1\alpha_1+\cdots+k_m\alpha_m=\mathbf{0} \Rightarrow \forall i, k_i =0$

						于是命题得证
					\end{proof}
					一个显然的推论是此结论的$n$个子空间的版本：
					\begin{corollary}{}
						设$A \in \hom(V,V)$，$\lambda_1,\cdots,\lambda_n$是$A$的$n$个互不相同的特征值

						如果$\forall i,\alpha_{ir_1},\cdots,\alpha_{ir_m} \in V_{\lambda_i}$线性无关

						那么向量组$\{\alpha_{jr_k}\}$也线性无关
					\end{corollary}
					\begin{proof}
						由数学归纳法易证
					\end{proof}
				\point{}
					
					容易注意到，矩阵的特征值和线性映射的特征值其实是一样的，正如下面的命题：
					\begin{proposition}
						设$V$是一个$F$上的线性空间，$\dim V = n < \aleph_0$，$\{\alpha_1,\cdots,\alpha_n\}$是$V$的一个基

						$A \in \hom(V,V)$在$\{\alpha_1,\cdots,\alpha_n\}$下的矩阵是$\symbfit{A}$

						那么，$\lambda $是$A$的一个特征值，$\alpha $是$A$的一个隶属于$\lambda $的一个特征向量$\Leftrightarrow$

						$\lambda $是$\symbfit{A}$的一个特征值，并且$\alpha $在$\{\alpha_1,\cdots,\alpha_n\}$下的坐标$\mathbf{x}$是$\symbfit{A}$的一个隶属于$\lambda $的特征向量
					\end{proposition}
					\begin{proof}
						$A(\alpha )=\lambda \alpha $

						$\Leftrightarrow \symbfit{A}\mathbf{x}=\lambda \mathbf{x}$（参见命题2.3.23）

						于是命题得证。
					\end{proof}
			\end{para}
		\subsection{特征矩阵与特征多项式}
			前面我们研究了特征值的性质，接下来我们想知道：是否可以直接去寻找计算特征值的直接方法？事实上，是可以的，我们指出：特征值是特征多项式的一个根，而特征向量是对应映射的核的一个元素

			先给出定义：
			\begin{defn}{线性变换的特征多项式}{}
				设$A \in \hom(V,V)$，我们称

				$\chi_A(\lambda )=\det(\lambda I-A)$

				为$A$的特征多项式
			\end{defn}
			类似地，我们可以定义矩阵的特征矩阵和特征多项式：
			\begin{defn}{矩阵的特征矩阵和特征多项式}{}
				设$\symbfit{A}\in M_n(F)$，我们称$\lambda \symbfit{I}-\symbfit{A}$是$\symbfit{A}$的特征矩阵

				并称$\chi_{\symbfit{A}}(\lambda )=\det(\lambda \symbfit{I}-\symbfit{A})$是$\symbfit{A}$的特征多项式
			\end{defn}
			下面的性质指出了我们想要的结果：
			\begin{para}{0}
				\point{}
					\begin{proposition}
						设$V$是一个$F$上的线性空间，$\dim V = n < \aleph_0$，$\{\alpha_1,\cdots,\alpha_n\}$

						如果$A \in \hom(V,V)$在$\{\alpha_1,\cdots,\alpha_n\}$下的矩阵是$\symbfit{A}$

						那么我们断言：$\chi_A(\lambda )=\chi_{\symbfit{A}}(\lambda )$
					\end{proposition}
					\begin{proof}
						这是显然的，因为矩阵的行列式的定义就是其矩阵的行列式
					\end{proof}
				\point{}
					\begin{proposition}
						$\forall \symbfit{A} \in M_n(F),\chi_{\symbfit{A}}\in F[\lambda ]$
					\end{proposition}
					\begin{proof}
						设$\symbfit{A}=(a_{ij})\in M_n(F)$

						那么，$\lambda\symbfit{I}-\symbfit{A}=\begin{pmatrix}
							\lambda-a_{11} & -a_{12} & \cdots & -a_{1n} \\
							-a_{21} & \lambda-a_{22} & \cdots & -a_{2n} \\
							\vdots & \vdots & \ddots & \vdots \\
							-a_{n1} & -a_{n2} & \cdots & \lambda-a_{nn}
						\end{pmatrix}$

						由行列式的置换展开可知，$\chi_{\symbfit{A}}(\lambda )\in F[\lambda ]$
					\end{proof}
					\begin{corollary}{}{}
						$\forall A \in \hom(V,V),\dim V = n < \aleph_0,\chi_A(\lambda )\in F[\lambda ]$
					\end{corollary}
					\begin{proof}
						这是显然的，因为我们只需要任取一个基$\{\alpha_1,\cdots,\alpha_n\}$，并利用$A$在此基下的矩阵$\symbfit{A}$

						利用前面线性映射与其矩阵的特征多项式相同的命题，即可得证。
					\end{proof}
				\point{}
					\begin{them}{线性变换的特征值即是特征多项式在域内的根}{}
						设$V$是一个$F$上的$n$维线性空间，$A \in \hom(V,V)$

						那么：$\lambda $是$A$的一个特征值，$\alpha \in V_\lambda \Leftrightarrow \chi_A(\lambda )=0,\alpha \in \ker(\lambda I-A)$
					\end{them}
					\begin{proof}
						$\lambda $是$A$的一个特征值，$\alpha \in V_\lambda$

						$\Leftrightarrow A(\alpha )=\lambda \alpha,V_\lambda \neq \{\mathbf{0}\}$

						$\Leftrightarrow (\lambda I-A)(\alpha )=\mathbf{0},\ker (\lambda I-A) \neq \{\mathbf{0}\}$

						$\Leftrightarrow \rank(\lambda I-A) < n,\alpha \in \ker(\lambda I-A)$

						$\Leftrightarrow \chi_A(\lambda )=0,\alpha \in \ker (\lambda I-A)$
					\end{proof}
					其自然推论是其矩阵版本：
					\begin{corollary}{}{}
						设$\symbfit{A} \in M_n(F)$

						那么：$\lambda $是$\symbfit{A}$的一个特征值，$\mathbf{x} \in F^n$是$\symbfit{A}$从属于$\lambda $的特征向量$\Leftrightarrow \chi_{\symbfit{A}}(\lambda )=0,(\lambda\symbfit{I}-\symbfit{A})\mathbf{x}=\mathbf{0},\mathbf{x}\neq \mathbf{0}$
					\end{corollary}
					这个推论也指出了一下结果：
					\begin{corollary}{}{}
						设$\symbfit{A},\symbfit{B} \in M_n(F),\symbfit{A}\sim \symbfit{B}$

						那么$\symbfit{A}$和$\symbfit{B}$具有相同的特征值，并且$\chi_{\symbfit{A}}(\lambda )=\chi_{\symbfit{B}}(\lambda )$
					\end{corollary}
					我们之后不再完全讨论矩阵版本的特征值相关定理，因为上面的结果已经说明了：相似矩阵，以及相互对应的矩阵和映射在特征值理论中并无区别
				\point{}
					\begin{proposition}
						设$V$是一个$F$上的$n$维线性空间，$A \in \hom(V,V)$

						那么：

						\begin{equation}
							\chi_A(\lambda )=\lambda^n - \tr(A) \lambda^{n-1} + \cdots + (-1)^{n-k} \left(\sum\limits_{j_1 < \cdots < j_{n-k}} A_{j_1,\cdots,j_{n-k}}^{j_1,\cdots,j_{n-k}}\right) \lambda^k + \cdots + (-1)^n \det(A)
						\end{equation}
					\end{proposition}
					\begin{proof}
						事实上，$\lambda^k$项即是下面的行列式求和：
						$\sum\limits_{j_1' < \cdots < j_{k}'}\begin{vmatrix}
						-a_{11} & \cdots & 0 & \cdots & 0 & \cdots & -a_{1n} \\
						\vdots & \ddots & \vdots & & \vdots & & \vdots \\
						-1 & \cdots & \lambda & \cdots & 0 & \cdots & 1 \\
						\vdots & & \vdots & \ddots & \vdots &  & \vdots \\
						-1 & \cdots & 0 & \cdots & \lambda & \cdots & 1 \\
						\vdots & & \vdots &  & \vdots & \ddots & \vdots \\
						-a_{n1} & \cdots & 0 & \cdots & 0 & \cdots & -a_{nn}
						\end{vmatrix}$
						其中行列式的$j_1',\cdots,j_{k}'$列为仅在第$j_i$个元素为$\lambda $，其他位置都是$0$的列。

						这是因为，如果想要产生$\lambda^k$，那么求和中的每一项必须选取对角线上的$k$个元素；同时，如果在进一步展开中选取了$-a_{ii}$而不是$\lambda $，那么会导致次数降低

						注意到：$\begin{vmatrix}
						-a_{11} & \cdots & 0 & \cdots & 0 & \cdots & -a_{1n} \\
						\vdots & \ddots & \vdots & & \vdots & & \vdots \\
						-1 & \cdots & \lambda & \cdots & 0 & \cdots & 1 \\
						\vdots & & \vdots & \ddots & \vdots &  & \vdots \\
						-1 & \cdots & 0 & \cdots & \lambda & \cdots & 1 \\
						\vdots & & \vdots &  & \vdots & \ddots & \vdots \\
						-a_{n1} & \cdots & 0 & \cdots & 0 & \cdots & -a_{nn}
						\end{vmatrix}$

						$=(-1)^{(j_1'+\cdots+j_{k}')+(j_1'+\cdots+j_{k}')}\det(diag\{\lambda,\cdots,\lambda \})(-1)^{n-k}A_{j_1,\cdots,j_{n-k}}^{j_1,\cdots,j_{n-k}}$

						这个结果只需要对$j_1',\cdots,j_k'$列展开即可得出，其中$(-1)^{n-k}$是将$-a_{ij}$前面的负号提出去得到的，而$j_1,\cdots,j_{n-k}$是与$j_1',\cdots,j_k'$互补的有限序列

						于是命题得证。
					\end{proof}
					其推论是以下结论：
					\begin{corollary}{}{}
						设$F$是一个代数闭域，$V$是一个$F$上的$n$维线性空间，$A \in \hom(V,V)$

						设$\lambda_1,\cdots,\lambda_n$是$A$的特征值（$\chi_A(\lambda )$中的重根按重数计算）

						那么有：
						\begin{equation}
							\prod\limits_{i=1}^{n} \lambda_i = \det(A)
						\end{equation}
						\begin{equation}
							\sum\limits_{i=1}^{n} \lambda_i = \tr(A)
						\end{equation}
					\end{corollary}
					\begin{proof}
						对$\chi_A(\lambda )$作唯一分解：

						$\chi_A(\lambda )=\prod\limits_{i=1}^{n}(\lambda -\lambda_i)$

						$=\lambda^n - (\lambda_1+\cdots+\lambda_n)\lambda^{n-1}+\cdots+(-1)^n \prod_{i=1}^{n}\lambda_i$

						结合前面的命题既得。
					\end{proof}
					请注意：这个命题必须要求$F$代数闭，否则可能$\chi_A(\lambda )$的根并非全体特征值，而导致论证失效。
			\end{para}
	\section{线性变换的对角标准型}
		本节中我们构建对角标准型的理论。对角标准型的理论是完全自然的，我们无需更多讨论，只需给出定义并直接推导充要条件即可。
		\subsection{对角标准型的定义}
			\begin{defn}{线性映射的对角标准型}{}
				设$V$是一个$F$上的一个线性空间，$\dim V = n < \aleph_0$

				如果存在一个基$\{\alpha_1,\cdots,\alpha_n\}$，使$A$在其上的矩阵$\symbfit{A}$是一个对角矩阵

				那么我们称$\symbfit{A}$为$A$的对角标准型，此时称$A$可对角化。
			\end{defn}
			类似地，我们可以定义矩阵的对角标准型
			\begin{defn}{矩阵的对角标准型}{}
				设$\symbfit{A} \in M_n(F)$，如果存在$\symbfit{P}\in GL_n(F)$和对角矩阵$\symbfit{D}\in M_n(F)$，使得

				$\symbfit{A}=\symbfit{P}^{-1}\symbfit{D}\symbfit{P}$

				那么我们称$\symbfit{D}$为$\symbfit{A}$的对角标准型，此时称$\symbfit{A}$可对角化。
			\end{defn}
			容易看出，线性映射的对角标准型与矩阵的对角标准型是等价的。特别地，如果认为$\symbfit{A}$是$A \in \hom(F^n,F^n)$在$\{\mathbf{e}_i\}$下的矩阵，那么容易发现：其实$\symbfit{P}^{-1}$的列向量就是$A$的特征向量。
		\subsection{线性变换可对角化的条件}
			观察对角矩阵的结构，既得以下显然的条件：
			\begin{them}{线性映射可对角化的条件(1)}{}
				设$V$是一个$F$上的一个线性空间，$\dim V = n < \aleph_0$

				那么：$A \in \hom(V,V)$可对角化$\Leftrightarrow$存在一个由$A$的特征向量组成的$V$的基
			\end{them}
			\begin{proof}
				$A \in \hom(V,V)$可对角化

				$\Leftrightarrow$存在一个基$\{\alpha_1,\cdots,\alpha_n\}$，使得$A$在其上的矩阵为$diag\{\lambda_1,\cdots,\lambda_n\}$

				$\Leftrightarrow A(\alpha_1,\cdots,\alpha_n)=diag\{\lambda_1,\cdots,\lambda_n\}(\alpha_1,\cdots,\alpha_n)$

				$\Leftrightarrow A(\alpha_1,\cdots,\alpha_n)=(\lambda_1\alpha_1,\cdots,\lambda_n \alpha_n)$

				$\Leftrightarrow \lambda_i$是$A$的特征值，$\alpha_i \in V_{\lambda_i}$

				$\Leftrightarrow $存在一个由$A$的特征向量组成的$V$的基
			\end{proof}
			\begin{corollary}{线性映射可对角化的条件(2)}{}
				设$V$是一个$F$上的一个线性空间，$\dim V = n < \aleph_0$

				那么：$A \in \hom(V,V)$可对角化$\Leftrightarrow$存在$n$个线性无关的特征向量
			\end{corollary}
			\begin{proof}
				这是显然的，因为$V$中的$n$个线性无关的向量一定组成一个基
			\end{proof}
			\begin{them}{线性映射可对角化的条件(3)}{}
				设$V$是一个$F$上的一个线性空间，$\dim V = n < \aleph_0$

				那么：$A \in \hom(V,V)$可对角化$\Leftrightarrow A$的全体不同的特征值$\lambda_1,\cdots,\lambda_s$，满足$V_{\lambda_1},\cdots,V_{\lambda_s}$的基的并集是$V$的基
			\end{them}
			\begin{proof}
				必要性由之前的命题是显然的。

				接下来证明充分性。

				如果$A$可对角化，那么，它一定能选取一个由特征向量组成的基$\{\alpha_{11},\cdots,\alpha_{1r_1},\cdots,\alpha_{s1},\cdots,\alpha_{sr_s}\}$，其中$\alpha_{ij}\in V_{\lambda_i},r_1+\cdots+r_s=n$

				我们只需证明，其实$\{\alpha _{i1},\cdots,\alpha_{ir_i}\}$就是$V_{\lambda_i}$的一个基

				首先，它一定线性无关，因为它是$V$的一个基的一个子集。不妨假设它不是$V_{\lambda_i}$的基，那么，一定$\exists \beta \in V_{\lambda_i}$，使得它不能被$\{\alpha _{i1},\cdots,\alpha_{ir_i}\}$线性表出

				那么，一定有$\{\alpha _{i1},\cdots,\alpha_{ir_i},\beta \}$线性无关。因为如果它线性相关，那么$\{\alpha _{i1},\cdots,\alpha_{ir_i}\}$一定是它的一个极大线性无关组，这使得$\beta $可以被$\{\alpha _{i1},\cdots,\alpha_{ir_i}\}$线性表出，矛盾。

				但是，我们之前已经指出，若干个特征子空间的线性无关向量的并集必定也是线性无关的，这说明$\alpha_{11},\cdots,\alpha_{1r_1},\cdots,\alpha_{s1},\cdots,\alpha_{sr_s},\beta $线性无关。但是$\dim V=n$，其中的$n+1$个向量不可能线性无关，矛盾。

				于是命题得证
			\end{proof}
			其推论是接下来的两个条件：
			\begin{corollary}{线性映射可对角化的条件(4)}{}
				设$V$是一个$F$上的一个线性空间，$\dim V = n < \aleph_0$

				那么：$A \in \hom(V,V)$可对角化$\Leftrightarrow $如果$\lambda_1,\cdots,\lambda_s$是$A$的全体不同的特征值，那么$V_{\lambda_1} \oplus \cdots \oplus V_{\lambda_s}=V$
			\end{corollary}
			\begin{proof}
				这是显然的，因为前面的命题指出了$V$的一个基正是$V_{\lambda_i}$的基组成的，而这正是直和的充要条件。
			\end{proof}
			\begin{corollary}{线性映射可对角化的条件(5)}
				设$V$是一个$F$上的一个线性空间，$\dim V = n < \aleph_0$

				那么：$A \in \hom(V,V)$可对角化$\Leftrightarrow $如果$\lambda_1,\cdots,\lambda_n$是$A$的全体不同的特征值，那么$\dim V_{\lambda_1}+\cdots+\dim V_{\lambda_s}=n$
			\end{corollary}
			\begin{proof}
				充分性由上面的命题是显然的。

				必要性只需注意到前面命题的结果，即存在一个$V$的基由全体特征子空间的基组成即可。
			\end{proof}
			至此，我们基本上得到了全部结果，最后我们将看到一个最终结果，它也是最常用的充要条件

			其实，我们已经注意到：如果特征子空间的维数之和不足，那么它就不可对角化。我们的一个天然的猜想是：特征子空间的维数是不是受限于特征值的重数？如果是的话，其实只需要填满这个重数就可以对角化。

			现在给出一个引理
			\begin{lemma}{几何重数小于代数重数}{}
				设$V$是一个$F$上的一个线性空间，$\dim V = n < \aleph_0$

				设$\lambda_i \in F$是$A \in \hom(V,V)$的一个特征值，并且其特征多项式有分解：

				$\chi_A(\lambda )=\prod\limits_{i=1}^{s} (\lambda-\lambda_i)^{r_i}$

				那么我们断言：$\dim V_{\lambda_i} \leqslant r_i$

				其中$\dim V_{\lambda_i}$也常常称为$\lambda_i$的几何重数，$r_i$称为$\lambda_i$的代数重数
			\end{lemma}
			\begin{proof}
				不妨设$\dim V_{\lambda_i}=d$

				取$V_{\lambda_i}$的一个基$\{\alpha_1,\cdots,\alpha_d\}$，并补全为$V$的一个基$\{\alpha_1,\cdots,\alpha_d,\cdots,\alpha_n\}$

				考虑$A$在此基上的矩阵$\symbfit{A}$，它一定具备以下形式：

				$\symbfit{A}=\begin{pmatrix}
					\lambda_i \symbfit{I}_d & \symbfit{B} \\
					\symbfit{O} & \symbfit{C}
				\end{pmatrix}$

				因为$A$在$\{\alpha_1,\cdots,\alpha_d\}$上的作用即是按照相同的特征值$\lambda_i$进行纯量乘法

				那么，特征矩阵$\lambda\symbfit{I}-\symbfit{A}=\begin{pmatrix}
					(\lambda -\lambda_i) \symbfit{I}_d & -\symbfit{B} \\
					\symbfit{O} & \lambda \symbfit{I}_{n-d}-\symbfit{C}\end{pmatrix}$

				于是有：$\chi_A(\lambda )=\det((\lambda -\lambda_i) \symbfit{I}_d)\det(\symbfit{I}_{n-d}-\symbfit{C})$

				$=(\lambda -\lambda_i)^d\det( \symbfit{I}_d)\det(\symbfit{I}_{n-d}-\symbfit{C})$

				因此一定有$d\leqslant r_i$，命题得证
			\end{proof}
			那么有以下命题：
			\begin{them}{线性映射可对角化的条件(6)}{}
				设$F$是一个代数闭域，$V$是一个$F$上的一个线性空间，$\dim V = n < \aleph_0$

				那么$A \in \hom(V,V)$可对角化$\Leftrightarrow$如果$\chi_A(\lambda)=\prod\limits_{i=1}^{s} (\lambda -\lambda_i)^{r_i} $，那么$\dim V_{\lambda_i}=r_i$
			\end{them}
			\begin{proof}
				必要性是显然的，因为这正是前面的命题给出的结果

				充分性只需注意到，如果可对角化必定有$\dim V_{\lambda_1}+\cdots+\dim V_{\lambda_s}$，但是引理已经指出$\dim V_{\lambda_i}\leqslant r_i$，又因为$r_1+\cdots+r_s=n$，那么一定有$\dim V_{\lambda_i}=r_i$

				于是命题得证。
			\end{proof}
		对角标准型的性质就是对角矩阵的性质，它们都很显然故无需阐述。可以看出来，对角标准型的条件是极其严苛的——这也是它优良性质的缘由。
	\section{线性变换的根子空间、不变子空间}
		我们转向不可对角化的线性映射的表示。

		我们观察可对角化的条件(4)，它的另一种表述是：

		$V=\ker(\lambda_1 I-A)\oplus \cdots \oplus \ker(\lambda_s I-A)$

		但是，我们知道，直和并不总是成立。我们的一个想法是：如果我们调整$\lambda_i I-A$的幂，是否能让他构成直和呢？如果能构成直和，这个幂有办法快速求出来吗？

		一个相当胡扯的想法是：特征多项式的分解$\chi_A(\lambda )=(\lambda -\lambda_1)^{r_1} \cdots (\lambda -\lambda_s)^{r_s}$似乎很符合我们的结构

		我们从特征多项式在映射上的作用，及其分解入手。
		\subsection{线性变换的多项式}
			此处我们希望讨论的，其实是一个具体的映射的多项式，也就是以下定义：
			\begin{defn}{线性映射的行列式}{}
				设$F$是一个域，$A \in \hom(V,V)$

				我们定义：
				\begin{equation}
					F[A]:=\{\sum\limits_{k=0}^{n}a_k A^k| a_k \in F,n \in \N\}
				\end{equation}
				称为$A$的多项式环，其元素称为$A$的多项式
			\end{defn}
			一个显然的事实是：$F[A]$是$\hom(V,V)$的子环

			接下来探讨线性变换的多项式的性质。
			\begin{para}{0}
				\point{Hamilton-Caylay定理}
					\begin{them}{Hamilton-Caylay定理}{}
						设$V$是一个$F$上的$n$维线性空间，$A \in \hom(V,V)$

						那么有：
						\begin{equation}
							\chi_A(A)=0
						\end{equation}
					\end{them}
					\begin{proof}
						设$M$是一个$F[A]$上的一个模，其元素和$V$一致，保持$V$中的加法，而其纯量乘法则为：

						$f(A)\cdot \alpha := f(A)(\alpha ),f(A) \in F[A],\alpha \in V$

						那么容易注意到，此时$A \in \hom(M,M)$，即成为$M$的一个自同态

						接下来我们尝试给出$\det(\lambda I-A)$在自同态下的一个表示。此处，我们尝试借助矩阵来完成这一步

						由于$M$其实和$V$有相同的元素，并且$F$本就是$F[A]$的子环，因此只需取$V$的一个基$\{e_1,\cdots,e_n\}$，它既是$M$的生成元

						那么，一定能写出$A$的在这一组生成元下的矩阵$\symbfit{A} \in M_n(F[A])$

						那么，$\det(\lambda I-A)=\det(\lambda \symbfit{I}-\symbfit{A})$（请注意，此处的$\symbfit{I},\symbfit{A}$是环上的矩阵，而非域上的矩阵）

						此时只需考察$\chi_A(A)=\det(A\symbfit{I}-\symbfit{A})$（由于此时矩阵已经是建立在环$F[A]$上的了，$A$成为了纯量，可以直接代入）

						记$\symbfit{P}=A\symbfit{I}-\symbfit{A},adj(\symbfit{P})=(\frac{1}{|\symbfit{P}|}\symbfit{P}_{\N-\{i\}}^{\N-\{j\}})$，并注意到：

						$\chi_A(A)(e_1,\cdots,e_n)=(e_1,\cdots,e_n)\det(\symbfit{P})=(e_1,\cdots,e_n)\symbfit{P}adj(\symbfit{P})$

						$(A(e_1,\cdots,e_n)-\symbfit{A}(e_1,\cdots,e_n))adj(\symbfit{P})=0$

						于是命题得证。
					\end{proof}
					这个定理看起来非常令人惊讶：特征多项式竟然可以直接把映射本身化为零。

					这个定理的一个常见的伪证是：直接把$A$代入，得到$\det(AI-A)=\det(0)=0$。但是，其实$\lambda $是一个纯量，并不能将映射代入。

					我们此处的证明正是基于这种想法进行了一个修改：将$F$视为环$F[A]$的子环，从而实现了正确的代入。
				\point{}
					\begin{proposition}
						设$A \in \hom(V,V)$，$f(x),f_1(x),f_2(x) \in F[x]$，$f(x)=f_1(x)f_2(x)$，$(f_1(x),f_2(x))=1$

						那么有：$\ker f(A) = \ker f_1(A) \oplus \ker f_2(A)$
					\end{proposition}
					\begin{proof}
						我们首先证明，$\ker f_1(A)$和$\ker f_2(A)$的确是$\ker f(A)$的子空间

						$\forall \alpha \in \ker f_1(A)$

						$\Rightarrow f_1(A)(\alpha )=\mathbf{0} \Rightarrow f(A)(\alpha )=\left(f_2(A)f_1(A)\right)(\alpha )=\mathbf{0}\Rightarrow \alpha \in \ker f(A) \Rightarrow \ker f_1(A) \subseteq \ker f(A)$

						同理可证$\ker f_2(A) \subseteq \ker f(A)$

						于是我们证明了$\ker f_1(A)+\ker f_2(A) \subseteq \ker f(A)$。现在我们证明$\ker f(A) \subseteq \ker f_1(A)+\ker f_2(A)$

						$\forall \alpha \in \ker f(A)$

						由于$(f_1(x),f_2(x))=1$，一定存在$u(x),v(x) \in F[x],u(x)f_1(x)+v(x)f_2(x)=1$

						于是有：$\alpha = I(\alpha )=\left(u(A)f_1(A)+v(A)f_2(A)\right)(\alpha )=\left(u(A)f_1(A)\right)(\alpha )+\left(v(A)f_2(A)\right)(\alpha )$

						记$\alpha_1=\left(u(A)f_1(A)\right)(\alpha ),\alpha_2=\left(v(A)f_2(A)\right)(\alpha )$

						注意到：$f_2(A)(\alpha_1)=\left(f_2(A)u(A)f_1(A)\right)(\alpha )=\left(u(A)f(A)\right)(\alpha )=u(A)(\mathbf{0})=\mathbf{0} \Rightarrow \alpha_1 \in \ker f_2(A)$

						同理可证$\alpha_2 \in \ker f_1(A)$。于是我们证明了$\ker f(A)=\ker f_1(A)+\ker f_2(A)$

						我们最后证明它们的确构成直和。

						$\forall \beta \in \ker f_1(A) \cap \ker f_2(A)$

						注意到：$\beta = I(\beta )=\left(u(A)f_1(A)+v(A)f_2(A)\right)(\beta )=\left(u(A)f_1(A)\right)(\beta )+\left(v(A)f_2(A)\right)(\beta )=\mathbf{0}$

						于是命题得证。
					\end{proof}
					这个命题的直接推论是：
					\begin{corollary}{--}{}
						设$A \in \hom(V,V)$，$ f(x),f_1(x),\cdots,f_s(x)\in F[x]$，$f(x)=\prod\limits_{i=1}^{s} f_i(x)$，$\forall i,j,(f_i(x),f_j(x))=1$

						那么有：$\ker f(A) = \bigoplus_{i=1}^{s} \ker f_i(A)$
					\end{corollary}
					至此，其实我们已经可以看出来一些方向了。我们已经证明了多项式如果分解为多个互素多项式，那么他们的核也可以构成直和。我们又注意到，任意映射在特诊多项式下为零。

					那么，其实特征多项式的唯一分解一定可以直和为零映射的核——即线性空间本身，这正是我们所期望的结果
			\end{para}
		\subsection{线性变换的根子空间}
			我们将这种理想的子空间为根子空间，因为它的常数是从特征多项式求出来的
			\begin{defn}{根子空间}{}
				设$F$是一个代数闭域，$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0$

				$\chi_A(\lambda )=\prod\limits_{i=1}^{s} (\lambda -\lambda_i)^{r_i}$

				那么我们称$\ker (A-\lambda_iI)^{r_i}$为$A$的一个根子空间（又称广义特征子空间）
			\end{defn}
			我们现在正式叙述我们观察到的结果
			\begin{them}{子空间分解定理}{}
				设$F$是一个代数闭域，$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0$

				$\chi_A(\lambda )=\prod\limits_{i=1}^{s} (\lambda -\lambda_i)^{r_i}$

				那么有：
				\begin{equation}
					V = \bigoplus\limits_{i=1}^{s} \ker (A-\lambda_i I)^{r_i}
				\end{equation}
			\end{them}
			至此，我们证实了，代数闭域上的任意有限维线性映射，都可以形成一个根子空间分解。

			接下来我们转向矩阵表示。在之前的对角标准型中，从特征值的定义可以看出来，每一个特征子空间表示为一个对角线上的元素。那么，现在我们希望：$A$在根子空间上的限制，都可以写成一个矩阵；特别地，如果每一个限制所属的子空间不同，此时我们便有可能写成分块对角矩阵
		\subsection{线性变换的不变子空间}
			一个首要的问题是：$A|_{\ker (A-\lambda_i I)^{r_i}}$到底能不能写成一个方阵的形式。如果它可以，那么，我们将不仅可以把映射写成分块对角矩阵，而且每一个块的具体形式可以借助线性变换来求得。

			总之，我们希望验证：是否任意代数闭域上的线性变换在根子空间上的限制是一个线性变换，而且这些线性变换在指定基下的矩阵，恰好可以分块地组成线性变换的矩阵

			我们首先给出不变子空间的定义，它其实就是使得变换的限制依旧为变换的子空间
			\begin{defn}{不变子空间}{}
				设$V$是$F$上的一个线性空间，$A \in \hom(V,V)$

				如果$V$的子空间$W \subseteq V$满足：

				$\forall \alpha \in W,A(\alpha ) \in W$

				那么我们称$W$是$A$的一个不变子空间
			\end{defn}
			显然，$V$和$\{\mathbf{0}\}$都是$A$的一个不变子空间，它们一般被称为是平凡的不变子空间

			接下来我们给出一些性质
			\begin{para}{0}
				\point{}
					\begin{proposition}
						设$V$是$F$上的一个线性空间，$A \in \hom(V,V)$，$\lambda $是$A$的一个特征值

						那么$\ker A,\im A,V_{\lambda }$是$A$的不变子空间
					\end{proposition}
					\begin{proof}
						$\forall \alpha \in \ker A,A(\alpha )=\mathbf{0} \in \ker A$

						$\forall \alpha \in \im A,A(\alpha ) \subseteq \im A$

						$\forall \alpha \in V_\lambda ,A(\alpha )=\lambda \alpha  \in V_\lambda $
					\end{proof}
				\point{}
					\begin{proposition}
						设$V$是$F$上的一个线性空间，$A,B \in \hom(V,V),AB=BA$，$\lambda $是$A$的一个特征值

						那么$\ker A,\im A,V_\lambda $是$B$的不变子空间
					\end{proposition}
					\begin{proof}
						$\forall \alpha \in \ker A,A(B(\alpha ))=B(A(\alpha ))=B(\mathbf{0})=\mathbf{0} \Rightarrow B(\alpha ) \in \ker A$

						$\forall A(\alpha) \in \im A,B(A(\alpha ))=A(B(\alpha )) \in \im A$0

						$\forall \alpha \in V_\lambda ,A(B(\alpha))=B(A(\alpha ))=B(\lambda \alpha )=\lambda B(\alpha ) \Rightarrow B(\alpha ) \in V_\lambda $

						于是命题得证。
					\end{proof}
				\point{}
					\begin{proposition}
						一个线性变换的两个不变子空间的和与交，也是不变子空间
					\end{proposition}
					\begin{proof}
						设$A \in \hom(V,V)$，$W,U$是$A$的不变子空间

						注意到：$\forall \alpha+\beta \in W+U,\alpha \in W,\beta \in U,A(\alpha +\beta )=A(\alpha )+A(\beta ) \in W+ U$

						$\forall \gamma \in W \cap U,A(\gamma ) \in W,A(\gamma ) \in U \Rightarrow A(\gamma ) \in W \cap U$

						于是命题得证
					\end{proof}
				\point{}

					最后一条性质，是我们所希望的结果：即如果把映射限制在一系列构成直和的不变子空间，那么矩阵也可以自然构成分块
					\begin{proposition}
						设$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0,A \in \hom(V,V)$，那么：

						$V = W_1 \oplus \cdots \oplus W_s$，其中$W_i$是$A$的不变子空间，且$A|_{W_i}$在基$B_i=\{\alpha_{i1},\cdots,\alpha_{ir_i}\}$下的矩阵为$\symbfit{A}_i$

						$\Leftrightarrow A$在$\{\alpha_{11},\cdots,\alpha_{1r_1},\cdots,\alpha_{s1},\cdots,\alpha_{sr_s}\}$下的矩阵为$\begin{pmatrix}
							\symbfit{A}_1 & &   \\
							& \ddots &  \\
							& &  \symbfit{A}_s
						\end{pmatrix}$
					\end{proposition}
					\begin{proof}
						先证充分性。

						首先，由于$W_1,\cdots,W_s$构成直和，因此$B_1 \cup \cdots \cup B_s$的确是$V$的一个基

						因为$A|_{W_i}$在$B_i$下的矩阵为$\symbfit{A}_i$，因此有：$A|_{W_i}(\alpha_{ij}) = \sum\limits_{k=1}^{r_i} \symbfit{A}_i (k;j)\alpha_{ik}$

						考察$A$在同样的向量上的作用：

						$A(\alpha_{ij})=A|_{W_i}(\alpha_{ij}) = \sum\limits_{k=1}^{r_i} \symbfit{A}_i (k;j)\alpha_{ik}$

						由基的线性无关性可知，以上是$A(\alpha_{ij})$的唯一表示。于是，$A$在基$B_1 \cup \cdots \cup B_s$下的矩阵$\symbfit{A}$分块后的第$i$列，当且仅当在$i$行为$\symbfit{A}_i$，其他均为$\symbfit{O}$

						于是一定有$\symbfit{A}=\begin{pmatrix}
							\symbfit{A}_1 & &   \\
							& \ddots &  \\
							& &  \symbfit{A}_s
						\end{pmatrix}$，充分性得证。

						接下来证明必要性。

						取$W_i = \span(\alpha_{i1},\cdots,\alpha_{ir_i})$

						由直和的充要条件可知，的确有$V = W_1 \oplus \cdots \oplus W_s$

						且由分块矩阵的结构可见：

						$(A|_{W_i})(\alpha_{i1},\cdots,\alpha_{ir_i})=(\alpha_{i1},\cdots,\alpha_{ir_i})\symbfit{A}$

						于是命题得证。
					\end{proof}
				\point{}
					我们本节提出的最后一个命题，是指出根子空间也是不变子空间，自然可以应用上面关于分块矩阵的命题
					\begin{proposition}
						设$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0$，

						如果$A \in \hom(V,V)$的特征多项式在$F$内有以下分解：

						$\chi_A (\lambda )=\prod\limits_{i=1}^{s} (\lambda-\lambda_i)^{r_i}$

						那么$A$的根子空间$\ker (A-\lambda_iI)^{r_i}$是$A$的不变子空间
					\end{proposition}
					\begin{proof}
						这其实是显然的，我们只需要注意到：$A(A-\lambda_i I)=A^2 - \lambda_i A = (A-\lambda_i I)A$
						
						即$A$和$A-\lambda_i I$是可交换的

						那么，按照数学归纳法，容易证明$A(A-\lambda_i I)^{r_i}=(A-\lambda_i I)^{r_i}A$

						于是有：

						$\forall \alpha \in \ker (A-\lambda_iI)^{r_i},(A-\lambda_iI)^{r_i}(\alpha )=\mathbf{0}$

						$\Rightarrow A(A-\lambda_iI)^{r_i}(\alpha )=\mathbf{0} \Rightarrow (A-\lambda_iI)^{r_i}(A(\alpha )) = \mathbf{0}$

						$\Rightarrow A(\alpha ) \in \ker (A-\lambda_iI)^{r_i}$

						于是命题得证。
					\end{proof}
			\end{para}
	\section{线性变换的最小多项式}
		前面我们指出了：只要特征多项式可分解为一次因式的乘积，那么线性空间就是根子空间的直和；进一步，我们只需求出线性变换在根子空间上的限制的矩阵，就可以对角地写出线性变换的矩阵

		本节中我们依旧选取多项式作为一个出发点，试图找到这些分块的具体形式。
		\subsection{最小多项式的定义}
			\begin{defn}{最小多项式}{}
				设$V$是$F$上的一个线性空间，$A \in \hom(V,V)$

				如果$f(x) \in F[x],f \neq 0$满足：

				\begin{enumerate}
					\item $f(A) = 0$
					\item $\forall g \in F[x] \wedge g(A) = 0,\operatorname{deg} f \leqslant \operatorname{deg} g$
					\item $f$是首一多项式
				\end{enumerate}
				那么我们称$f$是$A$的最小多项式。
			\end{defn}
		\subsection{最小多项式的性质}
			\begin{para}{0}
				\point{最小多项式是唯一的}
					\begin{proposition}
						任意线性变换的最小多项式是唯一的
					\end{proposition}
					\begin{proof}
						不妨假设$m_1(x),m_2(x)$均是$A \in \hom(V,V)$的最小多项式，且$m_1(x),m_2(x)$

						不妨假设$m_1(x)=\sum\limits_{k=0}^{n} a_k x^k,m_2(x)=\sum\limits_{k=0}^{n} b_k x^k$（由最小多项式的定义可知，它们一定同次）

						由最小多项式的定义可知，一定有$a_n=b_n=1$

						容易注意到，$m_1(x)-m_2(x)=\sum\limits_{i=0}^{n-1} (a_k-b_k)x^k$是零化的，因为$m_1(A)-m_2(A)=0-0=0$

						那么这是不可能的，因为此时，只需找出$m_1(x)-m_2(x)$相伴的首一多项式$m(x)$，它正是一个最小多项式，并且它的次数比$m_1(x),m_2(x)$低。
					\end{proof}
				\point{}
					\begin{proposition}
						设$m(x)$是$A \in \hom(V,V)$的最小多项式，那么：

						$p(x) \in F[x],p(A)=0 \Leftrightarrow m(x) \mid p(x)$
					\end{proposition}
					\begin{proof}
						先证充分性。

						对$p(x),m(x)$作带余除法：

						$\exists q(x),r(x) \in F[x],\operatorname{deg}r(x) < \operatorname{deg} m(x),p(x)=q(x)m(x)+r(x)$

						$\Rightarrow p(A)=q(A)m(A)+r(A) \Rightarrow 0=0+r(A) \Rightarrow r(A)=0$

						事实上，此时只可能有$r(A)=0$，因为我们已经指出，最小多项式是次数最低的零化多项式。

						那么此时有$p(x)=q(x)m(x)$，充分性得证。

						再证必要性。

						这其实是显然的，因为如果有$p(x)=q(x)m(x)$，此时$p(A)=q(A)m(A)=0$，于是必要性得证。

						于是命题得证。
					\end{proof}
					这个命题指出了一个事实：零化多项式环其实不仅是一个子环，而且是个理想；特别的，它是由最小多项式生成的主理想$(m(x))$
				\point{}

					接下来我们探讨有限维空间上的线性映射的最小多项式。这样的线性映射的最小多项式一定是存在的，因为我们知道特征多项式正好就是一个零化多项式
					\begin{proposition}
						设$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0$，$A \in \hom(V,V)$，$m(x)$是$A$的最小多项式

						那么$m(x)$和$\chi_A(x)$在$F$中有相同的根（但是重数不一定一致）
					\end{proposition}
					\begin{proof}
						由之前的命题可知，$m(x) \mid \chi_A(x)$，于是$m(x)$的任意根都是$\chi_A(x)$的根。

						于是我们只需证明$\chi_A(x)$在$F$中的任意根都是$m(x)$的根。

						设$m(x)=\sum\limits_{k=0}^{n} a_k x^k$

						我们之前已经指出，$\chi_A(x)$在$F$的根其实就是$A$的特征值。于是不妨设$\chi_A(\lambda )=0,\lambda \in F$

						$\Rightarrow \forall \alpha \in V_\lambda ,A(\alpha )=\lambda \alpha $

						$\Rightarrow \mathbf{0}=0(\alpha )=m(A)(\alpha )=\left(a_0 I+ a_1 A + \cdots + a_n A^n\right)(\alpha )$

						$=a_0 \alpha + a_1 A(\alpha )+\cdots + a_n A^n(\alpha )=a_0 \alpha + a_1 \lambda \alpha +\cdots+a_n \lambda ^n \alpha $

						$=\left(a_0+a_1 \lambda +\cdots + a_n \lambda^n\right)\alpha =m(\lambda )\alpha $

						又$\lambda \neq \mathbf{0}$，于是一定有$m(\lambda )=0$。

						于是命题得证。
					\end{proof}
				\point{}
					\begin{proposition}
						设$A \in \hom(V,V),V = W_1 \oplus \cdots \oplus W_s$，其中$W_i$是$A$的不变子空间

						那么如果$m_i(x)$是$A|_{W_i}$的最小多项式，那么$A$的最小多项式$m(x)$就是$m_1(x),\cdots,m_s(x)$的首一最小公倍式。
					\end{proposition}
					\begin{proof}
						设$q(x)$是$m_1(x),\cdots,m_s(x)$的首一最小公倍式。

						我们其实只需证明$q(x) \sim m(x)$

						先证明$q(x) \mid m(x)$

						考虑$\forall \alpha_i \in W_i,m(A|_{W_i})(\alpha_i)=m(A)(\alpha_i)=\mathbf{0}$

						由于$\alpha_i$的选取是任意的，因此一定有$m(A|_{W_i})=0$，即$m(x)$也是$A|_{W_i}$的零化多项式。

						那么，由之前的命题一定有$m_i(x) \mid m(x)$。

						于是$m(x)$也是$m_1(x),\cdots,m_s(x)$的公倍式。由于$q(x)$是他们的最小公倍式，一定有$q(x) \mid m(x)$

						接下来证明$m(x) \mid q(x)$。

						只需证明$q(A)=0$即可。设$\forall \alpha \in V,\alpha =\alpha_1+\cdots,\alpha_s,\alpha_i \in W_i$
						
						又因为$q(x)$是最小公倍式，因此一定有$q(x)=h_i(x)m_i(x)$

						注意到：$q(A)(\alpha )=q(A)\left(\sum\limits_{i=1}^{s} \alpha_i\right)=\sum\limits_{i=1}^{s}q(A)\left( \alpha_i\right)$

						$=\sum\limits_{i=1}^{s}q(A|_{W_i})\left( \alpha_i\right)=\sum\limits_{i=1}^{s}h_i(A|_{W_i})m_i(A|_{W_i})\left( \alpha_i\right)=\mathbf{0}$

						因为$\alpha $是随意选取的，因此必须有$q(A)=0$。那么按照前面的命题，有$m(x) \mid q(x)$

						于是我们证明了$m(x) \sim q(x)$。又两者都是首一的，因此必须有$m(x)=q(x)$

						于是命题得证。
					\end{proof}
				\point{}
					\begin{proposition}
						$A \in \hom(V,V)$是一个幂零指数为$l$的幂零多项式$\Leftrightarrow A$的最小多项式$m(x)=x^l$
					\end{proposition}
					\begin{proof}
						先证明充分性，注意到：$A^l=0$，因此$x^l$是$A$的零化多项式。

						那么一定有$m(x) \mid x^l$。但是我们知道，$\forall n < l,A^n \neq 0$，因此只可能$m(x)=x^l$

						必要性是显然的，因为如果$m(x)=x^l$，那么一定有$A^l=0$，且$\forall n < l,A^n \neq 0$

						于是命题得证。
					\end{proof}
				\point{}
					\begin{proposition}
						设$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0$，$A \in \hom(V,V)$，$m(x)$是$A$的最小多项式

						那么$A$可对角化$\Leftrightarrow m(x)$可在$F$中分解为互不相同的一次因式的乘积
					\end{proposition}
					\begin{proof}
						设$A$的全体互不相同的特征值为$\lambda_1,\cdots,\lambda_s$

						$A$可对角化$\Leftrightarrow V = V_{\lambda_1} \oplus \cdots \oplus V_{\lambda_s}$

						注意到，$\forall \alpha \in \ker (A-\lambda_i I),(A-\lambda_i I)|_{\ker (A-\lambda_i I)}(\alpha )=A(\alpha )-\lambda_i \alpha =\lambda_i \alpha -\lambda_i \alpha = \mathbf{0}$

						$\Rightarrow x-\lambda_i$是$A|_{\ker (A-\lambda_i I)}$的最小多项式（因为$x-\lambda_i$是零化多项式，而其唯一非零低阶因子$a$不是零化多项式）

						$\Leftrightarrow A$的零化多项式为$(x-\lambda_1)\cdots(x-\lambda_s)$

						因此$A$可对角化$\Leftrightarrow m(x)$可在$F$中分解为互不相同的一次因式的乘积
					\end{proof}
					其直接推论是：
					\begin{corollary}{幂零指数大于$1$的幂零变换不可对角化}{}
						设$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0$，$A \in \hom(V,V)$是一个幂零指数为$l$的幂零变换

						那么，如果$l >1$，则$A$不可对角化
					\end{corollary}
					\begin{proof}
						这是显然的，因为此时$A$的最小多项式为$x^l$，无法分解为不同的一次因式的乘积。
					\end{proof}
					\begin{corollary}{幂等变换可对角化}{}
						设$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0$，$A \in \hom(V,V)$是一个幂等变换

						那么$A$一定可对角化
					\end{corollary}
					\begin{proof}
						这是显然的，因为只需注意到$A^2=A \Rightarrow A(A-I)=0 \Rightarrow x(x-1)$是$A$的零化多项式

						那么，$A$的最小多项式作为$x(x-1)$的因子，一定可以分解为不同的一次因式的乘积

						于是命题得证
					\end{proof}
				\point{}
					最后，我们给出我们所需要的最终成果：
					\begin{proposition}
						设$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0$，$A \in \hom(V,V)$，$\lambda_1,\cdots,\lambda_s$是$A$的全体互不相同的特征值
						
						$m(x)=(x-\lambda_1)^{t_1}\cdots (x-\lambda_s)^{t_s}$是$A$的最小多项式

						那么，$A|_{\ker (A-\lambda_i I)^{t_i}}$的最小多项式为$(x-\lambda_i)^{t_i}$，

						且$(A-\lambda_i I)|_{\ker (A-\lambda_i I)^{t_i}}$是一个幂零指数为$t_i$的幂零变换
					\end{proposition}
					\begin{proof}
						因为最小多项式和特征多项式同根，此时一定有分解$\chi_A(x)=(x-\lambda_1)^{r_1}\cdots(x-\lambda_s)^{r_s}$

						我们之前已经证明了：$V = \ker(A-\lambda_1 I)^{r_1} \oplus \cdots \oplus \ker (A-\lambda_s I)^{r_s}$

						注意到：$\forall \alpha \in \ker(A-\lambda_i I)^{r_i},(A-\lambda_i I)^{r_i}|_{\ker (A-\lambda_i I)^{r_i}}(\alpha )=\mathbf{0}$

						因此，$(x-\lambda_i)^{r_i}$是$A|_{\ker (A-\lambda_i I)^{r_i}}$的零化多项式。不妨假设$A|_{\ker (A-\lambda_i I)^{r_i}}$的最小多项式$m_i(x)=(x-\lambda_i)^{l_i},l_i \leqslant r_i$

						那么，按照之前的命题，$A$的最小多项式一定是$m_1(x),\cdots,m_s(x)$的首一最小公倍式，又因为$m_1(x),\cdots,m_s(x)$两两互素，因此一定有$m(x)=(x-\lambda_1)^{l_1}\cdots(x-\lambda_s)^{l_s}$

						但是，我们已经假设了$m(x)=(x-\lambda_1)^{t_1}\cdots (x-\lambda_s)^{t_s}$，因此一定有$l_i=t_i$

						于是我们证明了$A|_{\ker (A-\lambda_i I)^{r_i}}$的最小多项式为$(x-\lambda_i)^{t_i}$

						此时只需注意到：因为$t_i < r_i$，所以一定有$\forall \alpha \in \ker (A-\lambda_i)^{t_i},(A-\lambda_i)^{r_i}(\alpha )=\mathbf{0}$，即$\ker (A-\lambda_i I)^{t_i} \subseteq \ker (A-\lambda_i I)^{r_i}$

						同时，由于$(x-\lambda_i)^{t_i}$是$A|_{\ker (A-\lambda_i I)^{r_i}}$的最小多项式，那么$\forall \alpha \in \ker(A-\lambda_i I)^{r_i},(A-\lambda_i I)^{t_i}|_{\ker (A-\lambda_i I)^{r_i}}(\alpha )=0(\alpha )=\mathbf{0}$

						那么，一定有$\ker (A-\lambda_i I)^{r_i} = \ker (A-\lambda_i I)^{t_i}$，于是命题的前半得证

						对于$(A-\lambda_i I)|_{\ker (A-\lambda_i)^{t_i}}$是幂零映射的证明，只需注意到：

						因为$A|_{\ker (A-\lambda_i I)^{t_i}}$的最小多项式为$(x-\lambda_i)^{t_i}$，所以$(A-\lambda_i I)^{t_i}|_{\ker (A-\lambda_i I)^{t_i}}=0$，且$\forall k < t_i,(A-\lambda_i I)^{k}|_{\ker (A-\lambda_i I)^{t_i}} \neq 0$

						因此$x^l$是$(A-\lambda_i I)|_{\ker (A-\lambda_i)^{t_i}}$次数最小的首一零化多项式，即最小多项式

						于是命题得证
					\end{proof}
					在这个结论的证明过程中，我们还指出了一个特殊的结果：
					\begin{corollary}{}{}
						设$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0$，$A \in \hom(V,V)$，$\lambda_1,\cdots,\lambda_s$是$A$的全体互不相同的特征值
						
						$m(x)=(x-\lambda_1)^{t_1}\cdots (x-\lambda_s)^{t_s}$是$A$的最小多项式

						那么，$V = \ker(A-\lambda_i I)^{t_1} \oplus \cdots \oplus \ker (A-\lambda_i I)^{t_s}$
					\end{corollary}
					前面的命题指出了两个事实：首先，线性变换可以分解为一些幂零变换；其次，特征多项式其实是不必要的，根子空间中的$r_i$其实也可以用$t_i$代替。
			\end{para}
	\section{线性变换的Jordan标准型}
		\subsection{Jordan矩阵与Jordan标准型}
			我们首先给出Jordan矩阵的定义
			\begin{defn}{Jordan块与Jordan矩阵}{}
				设$F$是一个域，$\lambda \in F,t \in \mathbb{N}^+$

				那么我们称矩阵
				\begin{equation}
					\symbfit{J}_t(\lambda )=\begin{pmatrix}
						\lambda & 1 &  &  &  \\
						 & \lambda & 1 &  &  \\
						 &  & \ddots & \ddots &  \\
						 &  &  & \lambda & 1 \\
						 &  &  &  & \lambda 
					\end{pmatrix} \in M_t(F)
				\end{equation}
				为一个主对角元为$a$的$t$阶的Jordan块

				特别地，我们称形如$diag\{\symbfit{J}_{t_1}(\lambda_1),\cdots,\symbfit{J}_{t_s}(\lambda_s)\}$的分块对角矩阵为Jordan矩阵
			\end{defn}
			接下来我们给出Jordan标准型的定义
			\begin{defn}{线性变换的Jordan标准型}{}
				设$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0$，$A \in \hom(V,V)$

				如果存在$V$的一个基，使得$A$在该基下的矩阵是一个Jordan矩阵，那么我们称该矩阵为$A$的Jordan标准型
			\end{defn}
			我们之前已经指出，只要特征多项式的根都在域$F$中，那么线性变换就可以分解为一些幂零变换。因此，本节中我们暂时先讨论幂零变换的Jordan标准型

			为了给出幂零变换的Jordan标准型，我们先给出循环子空间的定义：
			\begin{defn}{循环子空间}{}
				设$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0$，$A \in \hom(V,V)$
				
				如果$\exists \alpha  \in V$，使得$\alpha ,A(\alpha ),\cdots,A^{t-1}(\alpha )$线性无关

				且$\forall r \in \N_+,A^r(\alpha ) \in \span(\alpha ,A(\alpha ),\cdots,A^{t-1}(\alpha ))$

				那么我们称$\span\{\alpha ,A(\alpha ),A^2(\alpha ),\cdots,A^{t-1}(\alpha )\}$是一个$A$-循环子空间

				特别地，如果还有$A^t(\alpha )=\mathbf{0}$，我们称$\span\{\alpha ,A(\alpha ),A^2(\alpha ),\cdots,A^{t-1}(\alpha )\}$是一个$A$-强循环子空间
			\end{defn}
			容易注意到，$A-$强循环子空间是$A$的一个不变子空间
		\subsection{幂零变换的Jordan标准型}
			\begin{lemma}{}
				设$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0$，$A \in \hom(V,V)$

				如果$\alpha  \in V$满足：$A^l(\alpha )=\mathbf{0},A^{l-1}(\alpha )\neq \mathbf{0}$

				那么，对于$B=\{A^{l-1}(\alpha ),\cdots,A(\alpha ),\alpha \}$，$\span(B)$是一个$A$-强循环子空间，且$A|_{\span(B)}$在基$B$下的矩阵为$J_l(0)$
			\end{lemma}
			\begin{proof}
				首先证明$A^{l-1}(\alpha ),\cdots,A(\alpha ),\alpha $线性无关。

				考察线性组合$k_{l-1}A^{l-1}(\alpha )+\cdots+k_1 A(\alpha )+k_0 \alpha $

				对$k_i$作数学归纳法：

				首先，$k_0=0$，因为：$A^{l-1}(k_{l-1}A^{l-1}(\alpha )+\cdots+k_1 A(\alpha )+k_0\alpha)=\mathbf{0}$

				$\Rightarrow k_0 A^{l-1} (\alpha )=\mathbf{0} \Rightarrow k_0 = 0$

				现在假设$\forall t \leqslant n-1,k_t = 0$，我们来证明$k_n=0$

				注意到，此时$A^{l-n-1}(k_{l-1}A^{l-1}(\alpha )+\cdots+k_n A^n(\alpha ))=k_n A^{l-1}(\alpha )=\mathbf{0} \Rightarrow k_n=0$

				由强归纳原理，一定有$\forall i,k_i = 0$，于是线性无关性得证。

				$\forall r \in \N_+,A^r(\alpha ) \in \span(B)$是显然的，因为当$r \geqslant t,A^r(\alpha )=\mathbf{0}$

				于是我们证明了$\span(B)$是一个$A$-强循环子空间。

				接下来我们只需注意到，$A|_{\span(B)}(A^{l-i}(\alpha ))=A^{l-i+1}(\alpha )=\sum\limits_{k=1}^{l} \delta_{i-1,k}A^{l-k}(\alpha )$

				因此，$A|_{\span(B)}$在$B$下的矩阵$\symbfit{A}$一定满足：$\symbfit{A}(i-1;i)=1$，而其他元素均为$0$

				那么，这其实就是$\symbfit{A}=J_l(0)$

				于是命题得证。
			\end{proof}
			在证明过程中，我们其实也证明了：
			\begin{corollary}{}
				设$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0$，$A \in \hom(V,V)$是一个幂零指数为$l$的幂零变换

				那么一定有$ l \leqslant n$
			\end{corollary}
			\begin{proof}
				这是显然的，因为我们已经证明了：对于$\alpha \in V,A^l(\alpha )=\mathbf{0},A^{l-1}(\alpha )\neq \mathbf{0}$

				此时$A^{l-1}(\alpha ),\cdots,A(\alpha ),\alpha $线性无关。

				那么，其实一定有$l \leqslant n$，因为$n$维线性空间中不可能有超过$n$个线性无关的向量。

				于是命题得证。
			\end{proof}
			\begin{lemma}{}
				设$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0$，$A \in \hom(V,V)$是一个幂零指数为$l$的幂零变换

				那么，$V$可分解为$\dim V_0 = \dim \ker A$个强循环子空间的直和。
			\end{lemma}
			\begin{proof}
				对$n$作数学归纳法：

				当$n=1$，由于我们已经指出幂零指数无法超出维数，因此一定有$l=1$（$A^0=I\neq 0$，因此$l$不是零）

				此时，$A=0$，那么，其实只需要取$V$的一个基$\{\alpha \}$，此时显然$V=\span(\alpha)$是一个$A$-强循环子空间，因此命题显然成立

				现在假设$r< n$时命题成立

				首先，我们已经证明了$A=0$时命题成立，因此我们只需考虑$A \neq 0$的情况

				此时，$1 \leqslant \dim(V/\ker A) = \dim V - \dim \ker A< \dim V=n$

				于是，只需找到$V/\ker A$上的一个幂零变换，就可以在$V/\ker A$上应用假设。

				考虑映射：$\phi  : V/\ker A \ni \alpha + \ker A \mapsto A(\alpha )+\ker A$

				我们在证明秩-零化度定理时已经验证了这个映射的良定义性，此处不再讨论

				注意到：$\forall \alpha \in V/\ker A,\phi^l(\alpha+\ker A)=\phi ^l(\alpha )+\ker A = \ker A$。

				因此$\phi $是一个幂零指数小于等于$l$的幂零变换

				于是，依照假设，$V/\ker A$一定存在以下分解：

				$V/\ker A = \span(\alpha_1+\ker A,\cdots,\phi^{t_1-1}(\alpha_1+\ker A))\oplus \cdots \oplus \span(\alpha_k+\ker A,\cdots,\phi^{t_k-1}(\alpha_k+\ker A))$

				且其中$\span(\alpha_i+\ker A,\cdots,\phi^{t_i-1}(\alpha_i+\ker A))$是一个$\phi $-强循环子空间，即有 $\phi^{t_i}(\alpha_i+\ker A)=\ker A$

				那么，依照直和的等价条件，$\alpha_1+\ker A,\cdots,\phi^{t_1-1}(\alpha_1+\ker A),\cdots,\alpha_k+\ker A,\cdots,\phi^{t_k-1}(\alpha_k+\ker A)$是$V/\ker A$的一个基

				我们记$U = \span(\alpha_1,\cdots,A^{t_1-1}(\alpha_1),\cdots,\alpha_k,\cdots,A^{t_k-1}(\alpha_k))$

				那么此时有$V = U \oplus \ker A$

				此时注意之前强循环子空间的关键条件：$\phi ^{t_i}(\alpha_i+\ker A)=\ker A \Rightarrow A^{t_i}(\alpha_i) \in \ker A$

				考察线性组合$p_1 A^{t_1}(\alpha_1)+\cdots+p_k A^{t_k}(\alpha_k)=\mathbf{0}$

				$\Rightarrow A(p_1 A^{t_1-1}(\alpha_1)+\cdots+p_k A^{t_k-1}(\alpha_k))=\mathbf{0}$

				$\Rightarrow p_1 A^{t_1-1}(\alpha_1)+\cdots+p_k A^{t_k-1}(\alpha_k) \in \ker A$

				$\Rightarrow p_1 (A^{t_1-1}(\alpha_1)+\ker A)+\cdots+p_k (A^{t_k-1}(\alpha_k)+\ker A) \in \ker A$

				$\Rightarrow p_1,\cdots,p_k = 0$（因为之前证明了$\alpha_1+\ker A,\cdots,\phi^{t_1-1}(\alpha_1+\ker A),\cdots,\alpha_k+\ker A,\cdots,\phi^{t_k-1}(\alpha_k+\ker A)$是$V/\ker A$的一个基，即线性无关）

				于是我们证明了$A^{t_1}(\alpha_1),\cdots,A^{t_k}(\alpha_k) \in \ker A$线性无关

				于是它一定能补全成$\ker A$的一个基$\{A^{t_1}(\alpha_1),\cdots,A^{t_k}(\alpha_k),\beta_1,\cdots,\beta_s\}$

				那么此时：$V = U \oplus \ker A$

				$= \span(\alpha_1,\cdots,A^{t_1-1}(\alpha_1),\cdots,\alpha_k,\cdots,A^{t_k-1}(\alpha_k),\beta_1,\cdots,\beta_s) \oplus \span(A^{t_1}(\alpha_1),\cdots,A^{t_k}(\alpha_k),\beta_1,\cdots,\beta_s)$

				$= \span(\alpha_1,\cdots,A^{t_1-1}(\alpha _1),A^{t_1}(\alpha_1)) \oplus \cdots \oplus \span(\alpha_k,\cdots,A^{t_k-1}(\alpha_k),A^{t_k}(\alpha_k)) \oplus \span(\beta_1) \oplus \cdots \oplus \span(\beta_s)$

				我们来验证这些子空间的确是$A$-强循环子空间。其实，依照之前的命题，我们只需要验证最后一个元素是否是$A$的核即可，但是，这些元素正是$\ker A$的基，这是必定成立的。

				最后，我们注意到：$\dim \ker A = \card\{A^{t_1}(\alpha_1),\cdots,A^{t_k}(\alpha_k),\beta_1,\cdots,\beta_s\}=t+s$，而分解的数量也恰好是$t+s$，因此分解的数量正好是$\dim \ker A$
			\end{proof}
			现在，我们可以给出结论：幂零变换的Jordan标准型一定是存在的。
			\begin{them}{幂零变换的Jordan标准型}{}
				设$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0$，$A \in \hom(V,V)$是一个幂零指数为$l$的幂零变换

				那么一定存在一个基，使得它在此基下的矩阵是一个Jordan矩阵$diag\{J_{t_1}(0),\cdots,J_{t_k}(0)\}$，且其中$t_i \leqslant l$

				特别地，Jordan块的个数是$\dim \ker A$，其中$t$级Jordan块的个数$N(t)=\rank(B^{t-1})-2\rank(B^t)+\rank(B^{t+1})$
			\end{them}
			\begin{proof}
				首先，Jordan标准型的存在性是显然的，因为我们只需找到它的一个强循环子空间分解$V=W_1 \oplus \cdots \oplus W_s$，而按照我们之前证明的引理，

				我们首先证明：$\rank(J_l(0)^{t})=l-t,0 \leqslant t \leqslant l$

				我们来证明，$J_l(0)^t$是满足$J_l(0)(i;i+t)=1$，而其他元素均为$0$的矩阵。

				对$t$作数学归纳法。首先，当$t=1$，这就是Jordan块的定义，自然成立

				现在假设$t$时成立，我们来证明$t+1$时也成立：

				$J_{l}(0)^{t+1}(i;j)=\sum\limits_{k=1}^{l}J_l(0)^t(i;k)J_l(0)(k;j)$

				显然，只有当$k=i+t=j-1$时，$J_l(0)^t(i;k)J_l(0)(k;j)=1$，其他情况均为$0$，即当且仅有$J_{l}(0)^{t+1}(i;i+t)=1$

				于是由归纳法得证。那么，显然有：$\rank(J_l(0)^t)=l-t,0 \leqslant t \leqslant l$

				接下来我们只需注意到：$\rank(A^t)=\sum\limits_{k=t+1}^{l} N(k)(k-t)$（因为$diag\{\symbfit{J}_{t_1}(\lambda_1),\cdots,\symbfit{J}_{t_s}(\lambda_s)\}^{t}=diag\{\symbfit{J}_{t_1}(\lambda_1)^t,\cdots,\symbfit{J}_{t_s}(\lambda_s)^t\}$）

				于是有：$\rank(A^{t-1})=\sum\limits_{k=t}^{l} N(k)(k-t+1)$

				$\rank(A^{t+1})=\sum\limits_{k=t+2}^{l} N(k)(k-t-1)$

				于是可以注意到：$\rank(A^{t-1})+\rank(A^{t+1})-2\rank(A^t)$

				$=\sum\limits_{k=t+2}^{l} 2N(k)(k-t)+N(t)+2N(t+1)-2\sum\limits_{k=t+2}^{l}N(k)(k-t)-2N(t+1)=N(t)$

				于是命题得证。
			\end{proof}
		\subsection{线性变换的Jordan标准型}
			最后，我们应用我们给出的全部结论，给出我们的最终结果：线性变换的Jordan标准型

			我们回顾之前给出的结果，我们指出了可以分解为若干个不变子空间，每个子空间上是一个幂零变换和数量变换的和；我们又指出了幂零变换可以写出Jordan标准型

			结果已经很显然了：如果能给出根子空间分解，我们就可以写出Jordan标准型
			\begin{proposition}
				设$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0$，$A \in \hom(V,V)$
							
				那么，$A$的Jordan标准型存在$ \Leftrightarrow A$的最小多项式在$F$中存在分解$m(x)=(x-\lambda_1)^{t_1}\cdots (x-\lambda_s)^{t_s}$
			\end{proposition}
			\begin{proof}
				先证明必要性。

				由之前的命题，如果此形式的分解存在，那么一定有$V = \ker (A-\lambda_1 I)^{t_1}\oplus \cdots \oplus \ker (A-\lambda_s I)^{t_s}$

				但是，我们已经证明了，幂零变换$(A-\lambda_i I)|_{\ker (A-\lambda_i I)^{t_i}}$的Jordan标准型$diag\{J_{t_{i1}}(0),\cdots,J_{t_{ik_i}}(0)\}$

				那么$A|_{\ker (A-\lambda_i I)^{t_i}}$的Jordan标准型就是$diag\{J_{t_{i1}}(\lambda_i),\cdots,J_{t_{ik_i}}(\lambda_i)\}$

				于是$A$一定有标准型$diag\{J_{t_{11}}(\lambda_1),\cdots,J_{t_{1k_1}}(\lambda_1),\cdots,J_{t_{s1}}(\lambda_s),\cdots,J_{t_{sk_s}}(\lambda_s)\}$，于是必要性得证。

				我们接下来证明充分性

				充分性是显然的，因为对于Jordan标准型$diag\{J_{l_1}(\lambda_1),\cdots,J_{l_s}(\lambda_s)\}$，$J_{l_i}(\lambda_i)$所对应的线性变换的最小多项式是$(x-\lambda_i)^{l_i}$

				因此线性变换的最小多项式一定可以在$F$中分解为互若干一次因式的乘积，于是命题得证。
			\end{proof}
			有了以上命题，接下来我们阐述Jordan标准型的具体形式
			\begin{them}{线性变换的Jordan标准型}{}
				设$V$是$F$上的一个线性空间，$\dim V = n < \aleph_0$，$A \in \hom(V,V)$，
							
				$m(x)=(x-\lambda_1)^{t_1}\cdots (x-\lambda_s)^{t_s}$是$A$的最小多项式

				那么，$A$的Jordan标准型一定存在，且对角线元素为$\lambda_i$的Jordan块个数$N_i$，及$J_{t}(\lambda_i)$的个数$N_i(T)$分别为：

				\begin{equation}
					N_i = \operatorname{nullity}(A-\lambda_i I)
				\end{equation}
				\begin{equation}
					N_i(t) = \rank((A-\lambda_i I)^{t-1})-2\rank((A-\lambda_i I)^t)+\rank((A-\lambda_i I)^{t+1}),t \leqslant t_i
				\end{equation}
			\end{them}
			\begin{proof}
				首先，我们已经证明了此时Jordan标准型存在。我们来计算块的个数

				首先，我们已经指出，$V = \ker (A-\lambda_1 I)^{t_1} \oplus \cdots \oplus \ker (A-\lambda_s I)^{t_s}$

				此时，对于每一个子空间，一定能找到一个基$B_i$，使$(A-\lambda_i I)|_{\ker (A-\lambda_i I)^{t_i}}$在$B_i$下的矩阵为$diag\{J_{t_{i1}}(0),\cdots,J_{t_{ik_i}}(0)\}$

				于是，此时$A|_{\ker (A-\lambda_i I)^{t_i}}$在$B$下的矩阵为$diag\{J_{t_{i1}}(\lambda_i),\cdots,J_{t_{ik_i}}(\lambda_i)\}$。

				由于$\lambda_i$是互不相同的，其实此时一定有$N_i = t_i = \dim \ker ((A-\lambda_i I)|_{\ker (A-\lambda_i I)^{t_i}})$

				其实，此时$\ker (A-\lambda_i I)^{t_i}$的限制是完全没有必要的，因为注意到：$\forall \alpha \in \ker (A-\lambda_i I) \Rightarrow \alpha \in \ker(A-\lambda_i I)^{t_i}$

				因此，此时有$N_i = \operatorname{nullity}(A-\lambda_i I)$

				而$N_i(t)=\rank((A-\lambda_i I)^{t-1}|_{\ker(A-\lambda_i I)^{t_i}})-2\rank((A-\lambda_i I)^t|_{\ker(A-\lambda_i I)^{t_i}})+\rank((A-\lambda_i I)^{t+1}|_{\ker(A-\lambda_i I)^{t_i}})$

				$=(\dim \ker(A-\lambda_i I)^{t_i}-\dim \ker((A-\lambda_i I)^{t-1}|_{\ker(A-\lambda_i I)^{t_i+1}})-2(\dim \ker(A-\lambda_i I)^{t_i}-\dim \ker((A-\lambda_i I)^{t}|_{\ker(A-\lambda_i I)^{t_i}}))+(\dim \ker(A-\lambda_i I)^{t_i}-\dim \ker((A-\lambda_i I)^{t+1}|_{\ker(A-\lambda_i I)^{t_i}}))$

				$=-\dim \ker((A-\lambda_i I)^{t-1}|_{\ker(A-\lambda_i I)^{t_i+1}})+2\dim \ker((A-\lambda_i I)^{t}|_{\ker(A-\lambda_i I)^{t_i}}))-\dim \ker((A-\lambda_i I)^{t+1}|_{\ker(A-\lambda_i I)^{t_i}})$
			
				事实上，有：$\forall t,\ker((A-\lambda_i I)^t|_{\ker (A-\lambda_j I)^{t_j}})=\mathbf{0},i\neq j$

				这是因为：如果$i\neq j$，那么一定有$((x-\lambda_i)^t,(x-\lambda_j)^{t_j})=1$

				$\Rightarrow \exists u(x),v(x) \in F[x],u(x)(x-\lambda_i)^{t}+v(x)(x-\lambda_j)^{t_j}=1$

				代入$A|_{\ker (A-\lambda_j I)^{t_j}}$：

				$\Rightarrow u(A|_{\ker (A-\lambda_j I)^{t_j}})(A-\lambda_i I)^{t}|_{\ker (A-\lambda_j I)^{t_j}}+v(A|_{\ker (A-\lambda_j I)^{t_j}})(A-\lambda_j I)^{t_j}|_{\ker (A-\lambda_j I)^{t_j}}=1$

				$\Rightarrow u(A|_{\ker (A-\lambda_j I)^{t_j}})(A-\lambda_i I)^{t}|_{\ker (A-\lambda_j I)^{t_j}}=1$

				由$F[x]$可交换可知，此时$((A-\lambda_i I)^{t}|_{\ker (A-\lambda_j I)^{t_j}})^{-1}=u(A)|_{\ker (A-\lambda_j I)^{t_j}}$

				既然$(A-\lambda_i I)^{t}|_{\ker (A-\lambda_j I)^{t_j}}$可逆，那么一定有$\ker((A-\lambda_i I)^t|_{\ker (A-\lambda_j I)^{t_j}})=\mathbf{0}$

				那么，其实之前$N_i(t)$的计算公式中的子空间限制都是没有必要的（因为在其他子空间上的核都是零），因此有：

				$N_i(t)=-\dim \ker((A-\lambda_i I)^{t-1}|_{\ker(A-\lambda_i I)^{t_i+1}})+2\dim \ker((A-\lambda_i I)^{t}|_{\ker(A-\lambda_i I)^{t_i}}))-\dim \ker((A-\lambda_i I)^{t+1}|_{\ker(A-\lambda_i I)^{t_i}})$

				$-\dim((A-\lambda_i I)^{t-1})+2\dim\ker((A-\lambda_i I)^{t})-\dim\ker((A-\lambda_i I)^{t+1})$

				$=(\dim V-\dim\ker((A-\lambda_i I)^{t-1}))-2(\dim V-\dim\ker ((A-\lambda_i I)^{t}))+(\dim V-\dim\ker ((A-\lambda_i I)^{t+1}))$

				$=\rank((A-\lambda_i I)^{t-1})-2\rank((A-\lambda_i I)^{t})+\rank((A-\lambda_i I)^{t+1})$

				于是命题得证。
			\end{proof}
\ifx\allfiles\undefined
\end{document}
\fi